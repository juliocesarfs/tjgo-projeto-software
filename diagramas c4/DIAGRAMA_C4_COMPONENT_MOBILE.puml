@startuml C4_Component_ControlTasks_Mobile

!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

' ============================================================================
' COMPONENT DIAGRAM - Level 3
' Control Tasks Mobile Application - Componentes React Native
' ============================================================================

LAYOUT_WITH_LEGEND()

Person(userPerson, "User", "Usuário do sistema")
System_Ext(apiRest, "API REST", "Backend NestJS/TypeScript")

Container_Boundary(mobileAppContainer, "Mobile Application - React Native") {
    
    ' ============================================================================
    ' LAYER: SCREENS/NAVIGATION
    ' ============================================================================
    Component(loginScreen, "Login Screen", "React Native Screen", "Tela de autenticação:\n- Input de credenciais\n- Biometria/FaceID\n- Validação offline")
    
    Component(dashboardScreen, "Dashboard Screen", "React Native Screen", "Tela principal:\n- Cards de tarefas\n- Estatísticas rápidas\n- Ações principais")
    
    Component(notesListScreen, "Notes List Screen", "React Native Screen", "Lista de notas:\n- FlatList otimizada\n- Pull-to-refresh\n- Busca e filtros")
    
    Component(noteDetailScreen, "Note Detail Screen", "React Native Screen", "Detalhes da nota:\n- Visualização completa\n- Edição inline\n- Ações contextuais")
    
    Component(profileScreen, "Profile Screen", "React Native Screen", "Perfil do usuário:\n- Dados pessoais\n- Configurações do app\n- Sincronização")
    
    Component(notificationsScreen, "Notifications Screen", "React Native Screen", "Tela de notificações:\n- Lista de notificações de email\n- Marcar como lida\n- Filtros e busca")

    ' ============================================================================
    ' LAYER: NAVIGATION
    ' ============================================================================
    Component(stackNavigator, "Stack Navigator", "React Navigation", "Navegação em pilha:\n- Transições entre telas\n- Header customizado\n- Gestos de volta")
    
    Component(tabNavigator, "Tab Navigator", "React Navigation", "Navegação por abas:\n- Bottom tabs\n- Ícones e badges\n- Navegação rápida")

    ' ============================================================================
    ' LAYER: COMPONENTS (UI)
    ' ============================================================================
    Component(noteItem, "Note Item", "React Native Component", "Item de nota:\n- Layout responsivo\n- Swipe actions\n- Status visual")
    
    Component(notificationItem, "Notification Item", "React Native Component", "Item de notificação:\n- Dados da notificação\n- Badge de não lida\n- Swipe para marcar como lida")
    
    ' ============================================================================
    ' LAYER: SERVICES
    ' ============================================================================
    Component(authServiceMobile, "Auth Service", "TypeScript Service", "Autenticação mobile:\n- Login com biometria\n- Keychain/Keystore\n- Token refresh")
    
    Component(apiServiceMobile, "API Service", "TypeScript Service", "Cliente da API:\n- HTTP client\n- Retry logic\n- Network detection")
    
    Component(storageService, "Storage Service", "AsyncStorage/SQLite", "Armazenamento local:\n- Cache de dados\n- Configurações\n- Dados offline")
    
    Component(pushNotificationService, "Push Notification Service", "Firebase/APNs", "Notificações push:\n- Registro de token\n- Handling de mensagens\n- Badge management")

    ' ============================================================================
    ' LAYER: STATE MANAGEMENT
    ' ============================================================================
    Component(authContext, "Auth Context", "React Context", "Contexto de auth:\n- Estado global do usuário\n- Persistência de sessão\n- Logout automático")
    
    Component(notesContext, "Notes Context", "React Context", "Contexto de notas:\n- Cache local\n- Sincronização\n- Estado offline")
    
    Component(appContext, "App Context", "React Context", "Contexto do app:\n- Configurações globais\n- Theme management\n- Network status")
    
    Component(notificationsContext, "Notifications Context", "React Context", "Contexto de notificações:\n- Lista de notificações\n- Contador de não lidas\n- Cache local")

    ' ============================================================================
    ' LAYER: HOOKS
    ' ============================================================================
    Component(useAuthMobile, "useAuth Hook", "Custom Hook", "Hook de autenticação:\n- Biometria integration\n- Auto-login\n- Token management")
    
    Component(useOfflineSync, "useOfflineSync Hook", "Custom Hook", "Hook de sincronização:\n- Detecção de rede\n- Queue de requests\n- Sync automático")
    
    Component(usePushNotifications, "usePushNotifications Hook", "Custom Hook", "Hook de notificações:\n- Permission handling\n- Token registration\n- Message processing\n- Listar notificações recebidas")
}

System_Ext(biometricAuth, "Biometric Auth", "iOS FaceID/TouchID, Android Fingerprint")
System_Ext(pushService, "Push Service", "Firebase Cloud Messaging / APNs")

' ============================================================================
' RELACIONAMENTOS EXTERNOS
' ============================================================================

Rel(userPerson, loginScreen, "Acessa app", "Touch/Gestures")
Rel(userPerson, dashboardScreen, "Navega", "Touch Navigation")
Rel(userPerson, notificationsScreen, "Visualiza notificações", "Touch Navigation")

' ============================================================================
' RELACIONAMENTOS - NAVIGATION
' ============================================================================

Rel(stackNavigator, loginScreen, "Navega para", "Screen Transition")
Rel(stackNavigator, dashboardScreen, "Navega para", "Screen Transition")
Rel(stackNavigator, noteDetailScreen, "Navega para", "Screen Transition")

Rel(tabNavigator, dashboardScreen, "Tab navigation", "Bottom Tab")
Rel(tabNavigator, notesListScreen, "Tab navigation", "Bottom Tab")
Rel(tabNavigator, profileScreen, "Tab navigation", "Bottom Tab")
Rel(tabNavigator, notificationsScreen, "Tab navigation", "Bottom Tab")

' ============================================================================
' RELACIONAMENTOS - SCREENS → COMPONENTS
' ============================================================================

Rel(notesListScreen, noteItem, "Renderiza lista", "FlatList")
Rel(notificationsScreen, notificationItem, "Renderiza lista", "FlatList")

' ============================================================================
' RELACIONAMENTOS - SCREENS → HOOKS
' ============================================================================

Rel(loginScreen, useAuthMobile, "Usa", "React Hook")
Rel(dashboardScreen, useAuthMobile, "Usa", "React Hook")
Rel(dashboardScreen, useOfflineSync, "Usa", "React Hook")
Rel(notesListScreen, useOfflineSync, "Usa", "React Hook")
Rel(profileScreen, usePushNotifications, "Usa", "React Hook")
Rel(notificationsScreen, usePushNotifications, "Usa", "React Hook")

' ============================================================================
' RELACIONAMENTOS - HOOKS → SERVICES & CONTEXT
' ============================================================================

Rel(useAuthMobile, authServiceMobile, "Chama", "Function Call")
Rel(useAuthMobile, authContext, "Atualiza", "Context Update")
Rel(useOfflineSync, apiServiceMobile, "Chama", "Function Call")
Rel(useOfflineSync, storageService, "Usa cache", "Local Storage")
Rel(useOfflineSync, notesContext, "Atualiza", "Context Update")
Rel(usePushNotifications, pushNotificationService, "Gerencia push", "Function Call")
Rel(usePushNotifications, notificationsContext, "Atualiza estado", "Context Update")
Rel(usePushNotifications, storageService, "Cache local", "AsyncStorage")

' ============================================================================
' RELACIONAMENTOS - SERVICES → EXTERNAL
' ============================================================================

Rel(authServiceMobile, apiServiceMobile, "Usa para autenticação", "HTTP Client")
Rel(authServiceMobile, biometricAuth, "Biometria", "Native Module")
Rel(apiServiceMobile, apiRest, "Todas as requisições", "HTTP/REST")
Rel(pushNotificationService, pushService, "Registra token", "Push API")
Rel(storageService, notesContext, "Carrega cache", "AsyncStorage")

@enduml