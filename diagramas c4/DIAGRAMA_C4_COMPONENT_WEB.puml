@startuml C4_Component_ControlTasks_WebApp

!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

' ============================================================================
' COMPONENT DIAGRAM - Level 3
' Control Tasks Web Application - Componentes React/TypeScript
' ============================================================================

LAYOUT_WITH_LEGEND()

Person(userPerson, "User", "Usuário do sistema")
System_Ext(apiRest, "API REST", "Backend NestJS/TypeScript")

Container_Boundary(webAppContainer, "Web Application - React/TypeScript") {
    
    ' ============================================================================
    ' LAYER: PAGES/ROUTES
    ' ============================================================================
    Component(loginPage, "Login Page", "React Page", "Página de autenticação:\n- Formulário de login\n- Validação de campos\n- Redirecionamento")
    
    Component(dashboardPage, "Dashboard Page", "React Page", "Página principal:\n- Visão geral de tarefas\n- Cards de estatísticas\n- Navegação rápida")
    
    Component(notesPage, "Notes Page", "React Page", "Página de notas/tarefas:\n- Lista de notas\n- Filtros e busca\n- Paginação")
    
    Component(noteFormPage, "Note Form Page", "React Page", "Formulário de nota:\n- Criar/editar nota\n- Validação de campos\n- Upload de anexos")
    
    Component(profilePage, "Profile Page", "React Page", "Página de perfil:\n- Dados do usuário\n- Configurações\n- Alteração de senha")
    
    Component(teamsPage, "Teams Page", "React Page", "Página de times:\n- Lista de times\n- Criar/editar time\n- Gerenciar membros")
    
    Component(notificationsPage, "Notifications Page", "React Page", "Página de notificações:\n- Lista de notificações de email\n- Marcar como lida\n- Filtrar por tipo")

    ' ============================================================================
    ' LAYER: COMPONENTS (UI)
    ' ============================================================================
    Component(noteCard, "Note Card", "React Component", "Componente de nota:\n- Exibição de dados\n- Ações rápidas\n- Status visual")
    
    Component(teamCard, "Team Card", "React Component", "Componente de time:\n- Dados do time\n- Lista de membros\n- Ações de admin")
    
    Component(notificationCard, "Notification Card", "React Component", "Componente de notificação:\n- Dados da notificação\n- Status (lida/não lida)\n- Ação de marcar como lida")
    
    Component(sidebar, "Sidebar", "React Component", "Menu lateral:\n- Navegação principal\n- Filtros rápidos\n- User info")
    
    ' ============================================================================
    ' LAYER: SERVICES
    ' ============================================================================
    Component(authService, "Auth Service", "TypeScript Service", "Serviço de autenticação:\n- Login/logout\n- Gerenciar tokens\n- Refresh tokens")
    
    Component(apiService, "API Service", "TypeScript Service", "Cliente da API:\n- HTTP requests\n- Interceptors\n- Error handling")
    
    Component(notificationService, "Notification Service", "TypeScript Service", "Serviço de notificações:\n- Toast messages\n- Push notifications\n- WebSocket connection")

    ' ============================================================================
    ' LAYER: STATE MANAGEMENT
    ' ============================================================================
    Component(authStore, "Auth Store", "Zustand/Context", "Estado de autenticação:\n- Dados do usuário\n- Status de login\n- Permissions")
    
    Component(notesStore, "Notes Store", "Zustand/Context", "Estado das notas:\n- Lista de notas\n- Filtros ativos\n- Cache local")
    
    Component(teamsStore, "Teams Store", "Zustand/Context", "Estado dos times:\n- Lista de times\n- Membros\n- Permissões")
    
    Component(notificationsStore, "Notifications Store", "Zustand/Context", "Estado das notificações:\n- Lista de notificações\n- Contador de não lidas\n- Cache local")
    
    ' ============================================================================
    ' LAYER: HOOKS
    ' ============================================================================
    Component(useAuth, "useAuth Hook", "Custom React Hook", "Hook de autenticação:\n- Login/logout logic\n- Token management\n- User data")
    
    Component(useNotes, "useNotes Hook", "Custom React Hook", "Hook de notas:\n- CRUD operations\n- Filtering logic\n- Local cache")
    
    Component(useNotifications, "useNotifications Hook", "Custom React Hook", "Hook de notificações:\n- Real-time updates\n- Push notifications\n- Toast management")
    
    Component(useTeams, "useTeams Hook", "Custom React Hook", "Hook de times:\n- CRUD operations\n- Gerenciar membros\n- Permissões de admin")
    
    Component(useEmailNotifications, "useEmailNotifications Hook", "Custom React Hook", "Hook de notificações de email:\n- Listar notificações\n- Marcar como lida\n- Filtros")
}

' ============================================================================
' RELACIONAMENTOS EXTERNOS
' ============================================================================

Rel(userPerson, loginPage, "Acessa", "HTTPS")
Rel(userPerson, dashboardPage, "Navega", "SPA Navigation")
Rel(userPerson, notesPage, "Gerencia tarefas", "User Interaction")
Rel(userPerson, noteFormPage, "Cria/edita notas", "User Interaction")
Rel(userPerson, profilePage, "Gerencia perfil", "User Interaction")
Rel(userPerson, teamsPage, "Gerencia times", "User Interaction")
Rel(userPerson, notificationsPage, "Visualiza notificações", "User Interaction")

' ============================================================================
' RELACIONAMENTOS - PAGES → COMPONENTS
' ============================================================================


Rel(dashboardPage, sidebar, "Usa", "React Props")
Rel(dashboardPage, noteCard, "Renderiza", "React Props")


Rel(notesPage, sidebar, "Usa", "React Props")
Rel(notesPage, noteCard, "Renderiza lista", "React Props")


Rel(profilePage, sidebar, "Usa", "React Props")

Rel(teamsPage, sidebar, "Usa", "React Props")
Rel(teamsPage, teamCard, "Renderiza lista", "React Props")

Rel(notificationsPage, sidebar, "Usa", "React Props")
Rel(notificationsPage, notificationCard, "Renderiza lista", "React Props")

' ============================================================================
' RELACIONAMENTOS - PAGES → HOOKS
' ============================================================================

Rel(loginPage, useAuth, "Usa", "React Hook")
Rel(dashboardPage, useAuth, "Usa", "React Hook")
Rel(dashboardPage, useNotes, "Usa", "React Hook")
Rel(notesPage, useNotes, "Usa", "React Hook")
Rel(noteFormPage, useNotes, "Usa", "React Hook")
Rel(profilePage, useAuth, "Usa", "React Hook")
Rel(dashboardPage, useNotifications, "Usa", "React Hook")
Rel(notesPage, useNotifications, "Usa", "React Hook")
Rel(teamsPage, useTeams, "Usa", "React Hook")
Rel(teamsPage, useAuth, "Usa", "React Hook")
Rel(notificationsPage, useEmailNotifications, "Usa", "React Hook")
Rel(notificationsPage, useAuth, "Usa", "React Hook")

' ============================================================================
' RELACIONAMENTOS - HOOKS → SERVICES & STORES
' ============================================================================

Rel(useAuth, authService, "Chama", "Function Call")
Rel(useAuth, authStore, "Atualiza", "State Update")
Rel(useNotes, apiService, "Chama", "Function Call")
Rel(useNotes, notesStore, "Atualiza", "State Update")
Rel(useNotifications, notificationService, "Chama", "Function Call")
Rel(useTeams, apiService, "Chama", "Function Call")
Rel(useTeams, teamsStore, "Atualiza", "State Update")
Rel(useEmailNotifications, apiService, "Chama", "Function Call")
Rel(useEmailNotifications, notificationsStore, "Atualiza", "State Update")

' ============================================================================
' RELACIONAMENTOS - SERVICES → STORES
' ============================================================================

Rel(authService, authStore, "Atualiza estado", "State Management")

' ============================================================================
' RELACIONAMENTOS - SERVICES → API EXTERNA
' ============================================================================

Rel(authService, apiService, "Usa para autenticação", "HTTP Client")
Rel(notificationService, apiService, "Usa para WebSocket/SSE", "HTTP Client")
Rel(apiService, apiRest, "Todas as requisições", "HTTP/REST")

@enduml